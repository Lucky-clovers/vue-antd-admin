{"remainingRequest":"c:\\Users\\Administrator\\Desktop\\vue-antd-admin\\node_modules\\babel-loader\\lib\\index.js!c:\\Users\\Administrator\\Desktop\\vue-antd-admin\\node_modules\\eslint-loader\\index.js??ref--13-0!c:\\Users\\Administrator\\Desktop\\vue-antd-admin\\src\\router\\guards.js","dependencies":[{"path":"c:\\Users\\Administrator\\Desktop\\vue-antd-admin\\src\\router\\guards.js","mtime":1600420862420},{"path":"c:\\Users\\Administrator\\Desktop\\vue-antd-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1600423573509},{"path":"c:\\Users\\Administrator\\Desktop\\vue-antd-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1600416510814},{"path":"c:\\Users\\Administrator\\Desktop\\vue-antd-admin\\node_modules\\eslint-loader\\index.js","mtime":1600416522707}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzIjsKaW1wb3J0IHsgaGFzQXV0aG9yaXR5IH0gZnJvbSAnQC91dGlscy9hdXRob3JpdHktdXRpbHMnOwppbXBvcnQgeyBsb2dpbklnbm9yZSB9IGZyb20gJ0Avcm91dGVyL2luZGV4JzsKaW1wb3J0IHsgY2hlY2tBdXRob3JpemF0aW9uIH0gZnJvbSAnQC91dGlscy9yZXF1ZXN0JzsKLyoqDQogKiDnmbvlvZXlrojljasNCiAqIEBwYXJhbSB0bw0KICogQHBhcmFtIGZvcm0NCiAqIEBwYXJhbSBuZXh0DQogKiBAcGFyYW0gb3B0aW9ucw0KICovCgp2YXIgbG9naW5HdWFyZCA9IGZ1bmN0aW9uIGxvZ2luR3VhcmQodG8sIGZyb20sIG5leHQsIG9wdGlvbnMpIHsKICB2YXIgbWVzc2FnZSA9IG9wdGlvbnMubWVzc2FnZTsKCiAgaWYgKCFsb2dpbklnbm9yZS5pbmNsdWRlcyh0bykgJiYgIWNoZWNrQXV0aG9yaXphdGlvbigpKSB7CiAgICBtZXNzYWdlLndhcm5pbmcoJ+eZu+W9leW3suWkseaViO+8jOivt+mHjeaWsOeZu+W9lScpOwogICAgbmV4dCh7CiAgICAgIHBhdGg6ICcvbG9naW4nCiAgICB9KTsKICB9IGVsc2UgewogICAgbmV4dCgpOwogIH0KfTsKLyoqDQogKiDmnYPpmZDlrojljasNCiAqIEBwYXJhbSB0bw0KICogQHBhcmFtIGZvcm0NCiAqIEBwYXJhbSBuZXh0DQogKiBAcGFyYW0gb3B0aW9ucw0KICovCgoKdmFyIGF1dGhvcml0eUd1YXJkID0gZnVuY3Rpb24gYXV0aG9yaXR5R3VhcmQodG8sIGZyb20sIG5leHQsIG9wdGlvbnMpIHsKICB2YXIgc3RvcmUgPSBvcHRpb25zLnN0b3JlLAogICAgICBtZXNzYWdlID0gb3B0aW9ucy5tZXNzYWdlOwogIHZhciBwZXJtaXNzaW9ucyA9IHN0b3JlLmdldHRlcnNbJ2FjY291bnQvcGVybWlzc2lvbnMnXTsKICB2YXIgcm9sZXMgPSBzdG9yZS5nZXR0ZXJzWydhY2NvdW50L3JvbGVzJ107CgogIGlmICghaGFzQXV0aG9yaXR5KHRvLCBwZXJtaXNzaW9ucywgcm9sZXMpKSB7CiAgICBtZXNzYWdlLndhcm5pbmcoIlx1NUJGOVx1NEUwRFx1OEQ3N1x1RkYwQ1x1NjBBOFx1NjVFMFx1Njc0M1x1OEJCRlx1OTVFRVx1OTg3NVx1OTc2MjogIi5jb25jYXQodG8uZnVsbFBhdGgsICJcdUZGMENcdThCRjdcdTgwNTRcdTdDRkJcdTdCQTFcdTc0MDZcdTU0NTgiKSk7CiAgICBuZXh0KHsKICAgICAgcGF0aDogJy80MDMnCiAgICB9KTsKICB9IGVsc2UgewogICAgbmV4dCgpOwogIH0KfTsKLyoqDQogKiDmt7flkIjlr7zoiKrmqKHlvI/kuIvkuIDnuqfoj5zljZXot7Povazph43lrprlkJENCiAqIEBwYXJhbSB0bw0KICogQHBhcmFtIGZyb20NCiAqIEBwYXJhbSBuZXh0DQogKiBAcGFyYW0gb3B0aW9ucw0KICogQHJldHVybnMgeyp9DQogKi8KCgp2YXIgcmVkaXJlY3RHdWFyZCA9IGZ1bmN0aW9uIHJlZGlyZWN0R3VhcmQodG8sIGZyb20sIG5leHQsIG9wdGlvbnMpIHsKICB2YXIgc3RvcmUgPSBvcHRpb25zLnN0b3JlOwoKICBpZiAoc3RvcmUuc3RhdGUuc2V0dGluZy5sYXlvdXQgPT09ICdtaXgnKSB7CiAgICB2YXIgZmlyc3RNZW51ID0gc3RvcmUuZ2V0dGVyc1snc2V0dGluZy9maXJzdE1lbnUnXTsKCiAgICBpZiAoZmlyc3RNZW51LmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgcmV0dXJuIGl0ZW0uZnVsbFBhdGggPT09IHRvLmZ1bGxQYXRoOwogICAgfSkpIHsKICAgICAgc3RvcmUuY29tbWl0KCdzZXR0aW5nL3NldEFjdGl2YXRlZEZpcnN0JywgdG8uZnVsbFBhdGgpOwogICAgICB2YXIgc3ViTWVudSA9IHN0b3JlLmdldHRlcnNbJ3NldHRpbmcvc3ViTWVudSddOwoKICAgICAgaWYgKHN1Yk1lbnUubGVuZ3RoID4gMCkgewogICAgICAgIHJldHVybiBuZXh0KHsKICAgICAgICAgIHBhdGg6IHN1Yk1lbnVbMF0uZnVsbFBhdGgKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0KCiAgbmV4dCgpOwp9OwoKZXhwb3J0IGRlZmF1bHQgewogIGJlZm9yZUVhY2g6IFtsb2dpbkd1YXJkLCBhdXRob3JpdHlHdWFyZCwgcmVkaXJlY3RHdWFyZF0sCiAgYWZ0ZXJFYWNoOiBbXQp9Ow=="},{"version":3,"sources":["c:/Users/Administrator/Desktop/vue-antd-admin/src/router/guards.js"],"names":["hasAuthority","loginIgnore","checkAuthorization","loginGuard","to","from","next","options","message","includes","warning","path","authorityGuard","store","permissions","getters","roles","fullPath","redirectGuard","state","setting","layout","firstMenu","find","item","commit","subMenu","length","beforeEach","afterEach"],"mappings":";;;AAAA,SAAQA,YAAR,QAA2B,yBAA3B;AACA,SAAQC,WAAR,QAA0B,gBAA1B;AACA,SAAQC,kBAAR,QAAiC,iBAAjC;AAEA;;;;;;;;AAOA,IAAMC,UAAU,GAAG,SAAbA,UAAa,CAACC,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAiBC,OAAjB,EAA6B;AAAA,MACvCC,OADuC,GAC5BD,OAD4B,CACvCC,OADuC;;AAE9C,MAAI,CAACP,WAAW,CAACQ,QAAZ,CAAqBL,EAArB,CAAD,IAA6B,CAACF,kBAAkB,EAApD,EAAwD;AACtDM,IAAAA,OAAO,CAACE,OAAR,CAAgB,aAAhB;AACAJ,IAAAA,IAAI,CAAC;AAACK,MAAAA,IAAI,EAAE;AAAP,KAAD,CAAJ;AACD,GAHD,MAGO;AACLL,IAAAA,IAAI;AACL;AACF,CARD;AAUA;;;;;;;;;AAOA,IAAMM,cAAc,GAAG,SAAjBA,cAAiB,CAACR,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAiBC,OAAjB,EAA6B;AAAA,MAC3CM,KAD2C,GACzBN,OADyB,CAC3CM,KAD2C;AAAA,MACpCL,OADoC,GACzBD,OADyB,CACpCC,OADoC;AAElD,MAAMM,WAAW,GAAGD,KAAK,CAACE,OAAN,CAAc,qBAAd,CAApB;AACA,MAAMC,KAAK,GAAGH,KAAK,CAACE,OAAN,CAAc,eAAd,CAAd;;AACA,MAAI,CAACf,YAAY,CAACI,EAAD,EAAKU,WAAL,EAAkBE,KAAlB,CAAjB,EAA2C;AACzCR,IAAAA,OAAO,CAACE,OAAR,+EAAgCN,EAAE,CAACa,QAAnC;AACAX,IAAAA,IAAI,CAAC;AAACK,MAAAA,IAAI,EAAE;AAAP,KAAD,CAAJ;AACD,GAHD,MAGO;AACLL,IAAAA,IAAI;AACL;AACF,CAVD;AAYA;;;;;;;;;;AAQA,IAAMY,aAAa,GAAG,SAAhBA,aAAgB,CAACd,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAiBC,OAAjB,EAA6B;AAAA,MAC1CM,KAD0C,GACjCN,OADiC,CAC1CM,KAD0C;;AAEjD,MAAIA,KAAK,CAACM,KAAN,CAAYC,OAAZ,CAAoBC,MAApB,KAA+B,KAAnC,EAA0C;AACxC,QAAMC,SAAS,GAAGT,KAAK,CAACE,OAAN,CAAc,mBAAd,CAAlB;;AACA,QAAIO,SAAS,CAACC,IAAV,CAAe,UAAAC,IAAI;AAAA,aAAIA,IAAI,CAACP,QAAL,KAAkBb,EAAE,CAACa,QAAzB;AAAA,KAAnB,CAAJ,EAA2D;AACzDJ,MAAAA,KAAK,CAACY,MAAN,CAAa,2BAAb,EAA0CrB,EAAE,CAACa,QAA7C;AACA,UAAMS,OAAO,GAAGb,KAAK,CAACE,OAAN,CAAc,iBAAd,CAAhB;;AACA,UAAIW,OAAO,CAACC,MAAR,GAAiB,CAArB,EAAwB;AACtB,eAAOrB,IAAI,CAAC;AAACK,UAAAA,IAAI,EAAEe,OAAO,CAAC,CAAD,CAAP,CAAWT;AAAlB,SAAD,CAAX;AACD;AACF;AACF;;AACDX,EAAAA,IAAI;AACL,CAbD;;AAeA,eAAe;AACbsB,EAAAA,UAAU,EAAE,CAACzB,UAAD,EAAaS,cAAb,EAA6BM,aAA7B,CADC;AAEbW,EAAAA,SAAS,EAAE;AAFE,CAAf","sourcesContent":["import {hasAuthority} from '@/utils/authority-utils'\r\nimport {loginIgnore} from '@/router/index'\r\nimport {checkAuthorization} from '@/utils/request'\r\n\r\n/**\r\n * 登录守卫\r\n * @param to\r\n * @param form\r\n * @param next\r\n * @param options\r\n */\r\nconst loginGuard = (to, from, next, options) => {\r\n  const {message} = options\r\n  if (!loginIgnore.includes(to) && !checkAuthorization()) {\r\n    message.warning('登录已失效，请重新登录')\r\n    next({path: '/login'})\r\n  } else {\r\n    next()\r\n  }\r\n}\r\n\r\n/**\r\n * 权限守卫\r\n * @param to\r\n * @param form\r\n * @param next\r\n * @param options\r\n */\r\nconst authorityGuard = (to, from, next, options) => {\r\n  const {store, message} = options\r\n  const permissions = store.getters['account/permissions']\r\n  const roles = store.getters['account/roles']\r\n  if (!hasAuthority(to, permissions, roles)) {\r\n    message.warning(`对不起，您无权访问页面: ${to.fullPath}，请联系管理员`)\r\n    next({path: '/403'})\r\n  } else {\r\n    next()\r\n  }\r\n}\r\n\r\n/**\r\n * 混合导航模式下一级菜单跳转重定向\r\n * @param to\r\n * @param from\r\n * @param next\r\n * @param options\r\n * @returns {*}\r\n */\r\nconst redirectGuard = (to, from, next, options) => {\r\n  const {store} = options\r\n  if (store.state.setting.layout === 'mix') {\r\n    const firstMenu = store.getters['setting/firstMenu']\r\n    if (firstMenu.find(item => item.fullPath === to.fullPath)) {\r\n      store.commit('setting/setActivatedFirst', to.fullPath)\r\n      const subMenu = store.getters['setting/subMenu']\r\n      if (subMenu.length > 0) {\r\n        return next({path: subMenu[0].fullPath})\r\n      }\r\n    }\r\n  }\r\n  next()\r\n}\r\n\r\nexport default {\r\n  beforeEach: [loginGuard, authorityGuard, redirectGuard],\r\n  afterEach: []\r\n}\r\n"]}]}